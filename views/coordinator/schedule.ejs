<!doctype html>
<html lang="en" class="high">
<head>
  
<meta charset="utf-8">

<!-- Always force latest IE rendering engine or request Chrome Frame -->
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

<meta name="viewport" content="width=device-width, minimal-ui, initial-scale=1, maximum-scale=1.0, user-scalable=no">


<!-- Apple Touch -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/wrap/images/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/wrap/images/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/wrap/images/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/wrap/images/apple-touch-icon-57-precomposed.png">

<!-- Favicon -->
<link rel="shortcut icon" href="/wrap/images/favicon.png">

<!-- Use title if it's in the page YAML frontmatter -->
<title>Schedule</title>

<script type="text/javascript">
    var polyfilter_scriptpath = "/wrap/polyfills/filters/";
    window.polyfilter_skip_stylesheets = true
</script>

 <link href="/wrap/stylesheets/application.css" rel="stylesheet" type="text/css" />
 <link href="/stylesheets/style-new.css" rel="stylesheet" type="text/css" />
 <link href="/stylesheets/slick/slick.css" rel="stylesheet" type="text/css" />
 
<!--[if lte IE 9]>
<link href="/wrap/stylesheets/application_split2.css" rel="stylesheet" type="text/css" /><link href="/wrap/stylesheets/application_split3.css" rel="stylesheet" type="text/css" />
<![endif]-->
  <script src="/wrap/javascripts/application.js" type="text/javascript"></script>
  <script src="/wrap/javascripts/demo.js" type="text/javascript"></script>
  <script src="/wrap/javascripts/init.js" type="text/javascript"></script>
 
 	<link href="/stylesheets/fullcalendar.min.css" rel="stylesheet" type="text/css" />
 	<script src="/javascripts/fullcalendar.min.js" type="text/javascript"></script>
</head>

<body class="high emerald-default htmls htmls_dashboard">
<!-- start modal -->
<div class="modal modal-light fade" id="uide4b3dde6bb5097375d99eb18a83d7146">
	<div class="modal-footer">
    	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    	<button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
  	</div>
</div>
<div class="modal modal-light fade" id="opentok">
	<div class="modal-footer">
    	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    	<button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
  	</div>
</div>
<!-- end modal -->

<div id="spinner" class="spinner">
    <img src="/images/ajax-loader.gif" alt="Spinner"/>
</div>

<div id="node-dialog-container"></div>


<div class="oc-xs-push-push oc-sm-squeeze-push oc-md-squeeze-push oc-lg-squeeze-push modal-blur-content">

	<div id="oc-wrapper" class="oc-wrapper
       oc-lg-open-left oc-md-partial-left oc-sm-partial-left
       oc-lg-left-squeeze oc-md-left-squeeze oc-sm-left-squeeze oc-xs-left-push
       oc-lg-right-push oc-md-right-push oc-sm-right-push oc-xs-right-push
       ">

    <div class="oc-push" style="overflow-x: hidden; overflow-y: auto">
      
      <aside id="main-oc-sidebar-left" class="oc-sidebar oc-sidebar-left oc-sidebar-fixed nano">
        <div class="nano-content">
          

<div class="oc-sidebar-header">
  <ul class="nav nav-justified-all">
    <li>
      <a id="oc-left-toggle" href="#oc-wrapper"
         class="btn-nav" style="width: 50px;"
         data-toggle="offcanvas" data-control="left"
         data-states="open,partial"
         data-persist="lg,md,sm"
         data-parent="body" data-sibling="right">
        <i class="icm icm-menu6 oc-partial-rotate"></i>
      </a>
    </li>
    <!--<li>
<a class="btn-nav" data-toggle="modal" href="#jump-to-menu">        <i class="icm icm-arrow-right6"></i>
</a>    </li>-->
    <!--<li>
      <a class="btn-nav" href="#" rel="popover-click"
         data-toggle="popover"
         data-container="body"
         data-placement="bottom">
        <i class="icm icm-bubbles5 has-corner-badge animated tada">
          <span class="badge badge-corner badge-corner-top-right badge-info-dk">
            <i class="fa fa-exclamation"></i>
          </span>
        </i>
      </a>
    </li>-->
    <!-- <li>
<a href="pages/inbox.html">          <i class="icm icm-envelope3 has-corner-badge">
            <span class="badge badge-corner badge-corner-top-right badge-primary-dk">4</span>
          </i>
</a>    </li>-->
  </ul>
</div>

<div class="oc-sidebar-content" id="collapseAvatarLeft">
  <ul class="nav nav-stacked oc-sidebar-nav visible-xs">
    <li class="dropdown">
      <a href="#dropdownUserSidebar" class="collapsed"  data-toggle="collapse" data-parent="#collapseAvatarLeft">
        <div class="media">
          <img class="img-circle media-object pull-left" src="/wrap/images/faker/avatars/48/Faces_Users-23.png" />
          <div class="media-body">
            <h4 class="media-heading"><%= currentUser.first_name != null ? currentUser.first_name : currentUser.username %></h4>
            Et repellat at laudantium corporis laboriosam q...
          </div>
        </div>
      </a>
      <ul class="collapse dropdown-menu" id="dropdownUserSidebar" style="display: block">
        <li>
          <a href="/logout">
            <i class="icm icm-switch text-danger"></i> <span class="text-danger">Sign out</span>
          </a>
        </li>
      </ul>
    </li>
  </ul>

  

</div>

        </div>
      </aside>

      <div id="main-oc-container" class="oc-container" style="margin-left: 0px">
        <nav class="navbar navbar-default navbar-static-top navbar-inplace" role="navigation">
		  <ul class="nav navbar-nav navbar-left pull-left hidden-sm hidden-md hidden-lg">
		    <li>
		      <a id="oc-left-toggle-xs" href="#oc-wrapper"
		         class="btn-nav pull-left "
		         data-toggle="offcanvas" data-control="left"
		         data-states="open,hidden"
		         data-persist="lg,md,sm"
		         data-parent="body" data-sibling="right">
		        <i class="icm icm-menu6"></i>
		      </a>
		    </li>
		  </ul>
		<a class="navbar-brand" href="">    
		    <span class="text-gradient-success-dk"><i class="icm icm-cube icm-2x"></i>&nbsp;iLAB</span>
		</a>  
		  <ul class="nav navbar-nav navbar-right pull-right hidden-xs">
		    <li class="dropdown">
		      <a href="#" data-toggle="dropdown" class="navbar-img-link">
		        <img class="img-circle" src="/wrap/images/faker/avatars/48/Faces_Users-11.png" />
		        <span class="hidden-xs hidden-sm hidden-md"><%= currentUser.first_name %></span>
		        <b class="caret"></b>
		      </a>
		      <ul class="dropdown-menu animated fadeIn fast">
		       <!-- <li>
		<a href="">            <i class="fa fa-user"></i> Profile
		</a>        </li>
		        <li>
		<a href="">            <i class="fa fa-cog"></i> Settings
		</a>        </li>-->
		        <li>
		          
		<a href="/logout">              <i class="fa fa-power-off text-danger"></i>
		              <span class="text-danger">Sign out</span>
		</a>          
		        </li>
		      </ul>
		    </li>
		  </ul>
		  
		</nav>

	<!-- start container-fluid -->
    <div class="container-fluid turbo-cols-static turbo-grid-wrap gym">
		
		<div class="turbo-grid"> <!-- start turbo grid -->
		 	
		 	<ul class="nav nav-tabs">
				<li><a href="/coordinator/dashboard/<%= currentUser.id %>">OPS</a></li>
				<li class="active"><a href="/coordinator/schedule/<%= user_id %>">SCHEDULER</a></li>
				<li><a>MASTER</a></li>
				<li><a>CONFIG</a></li>
				<li><a>REPORTS</a></li>
			</ul>
			
			<div class="tab-content bg-white padded margin-bottom" style="overflow: hidden;">
				<div class="tab-pane fade in active">
					<div style="width: 100%; float: right; padding-bottom: 15px">
						<a class="btn btn-primary pull-right turbo-card turbo-toggle" data-back-class="bg-info" data-turbo-url="/coordinator/create_new_schedule_bulk/<%= currentUser.id %>" style="margin: 0px 4px">Create Schedule (Bulk)</a>
						<a class="btn btn-warning pull-right" onclick="confirm_schedule()" style="margin: 0px 4px">Confirm Schedule</a>
						<a class="btn btn-success pull-right turbo-card turbo-toggle" data-back-class="bg-info" data-turbo-url="/coordinator/create_new_schedule/<%= currentUser.id %>" style="margin: 0px 4px">Create New Schedule</a>
						<a class="btn btn-info pull-right" target="_blank" href="/misc/create_kerala_schedule" style="margin: 0px 4px">Create Kerala Schedule</a>
					</div>
					<div id="fullcalendar"></div>
				</div>
			</div>
		
		</div> <!-- end turbo grid -->
	
	</div>
	<!-- end container fluid -->	  
	
	<div id="calendar-popup"></div>
		
</div>
</div>
</div>
</div>

  
<!-- Needed by BSE.Mq.screen() helper in utils.js -->
<div id="mq"></div>

<!-- Needed by EmVars helper in _emerald.js -->
<div id="emvars"></div>
<script src="/javascripts/script.js" type="text/javascript"></script>
<!--<script src="/javascripts/slick.min.js" type="text/javascript"></script>-->
<script>
	$('#fullcalendar').fullCalendar({
        header: {
			right: 'prev,next today',
			center: 'title',
			left: 'month,agendaWeek,agendaDay'
		},
		//editable: false,
		defaultView: 'agendaWeek',
		events: [
			<% events.forEach(function(event, i) { %>
				{
					id: '<%= event.id %>',
					//title: '<%= event.name %>-<%= event.organization.name %> <%= event.ModeratorId != null && event.trainer != null ? ""+event.trainer.username : "" %> <%= event.skill != null ? "Skill -"+event.skill.name : "" %> <%= event.module != null ? "Module -"+event.module.name : "" %>',
					title: '<%= event.name %>-<%= event.organization.name %> <%= event.ModeratorId != null && event.trainer != null ? ""+event.trainer.username : "" %>',
					start: '<%= event.date %>',
					end: '<%= event.endDate %>',
					allDay: false,
					color:'<%= event.status == "Created Event" ? "#177bbb" : (event.status == "Trainer Conflict" || event.status == 'Coordinator Confirmed Event With Conflict' ? "#e33244" : (event.status == "Assigned Trainer" ? "#fbb23e" : (event.status == "Coordinator Confirmed Event" || event.status == "Trainer Accepted Invite" ? "#22ba93" : "#000")))%>',
					textColor: '#fff'
				}
				<% if(i < events.length - 1) { %>
				,
				<% } %>
			<% }); %>
		],
		/*eventClick: function(event,jsEvent) {
	        $("body").append('<div class="modal-backdrop fade in"></div>');
	        $('body').addClass('modal-open');
			$('#uide4b3dde6bb5097375d99eb18a83d7146').addClass("in");
			$('#uide4b3dde6bb5097375d99eb18a83d7146').show();
			ajax_call('/coordinator/assign_skill_trainer_to_event/'+event.id,'uide4b3dde6bb5097375d99eb18a83d7146');
		},
		eventMouseover: function(event,jsEvent) {
	        var offsetTop = Math.abs($(this).offset().top);
			var offsetLeft = Math.abs($(this).offset().left);
			$.ajax({
				url: "/coordinator/get_event_details/"+event.id,
				success: function(data) {
					$('#calendar-popup').css('top',(offsetTop)+'px');
					$('#calendar-popup').html(data);
					$('#calendar-popup').css('left',Math.abs(offsetLeft-$('#calendar_popup').width())+'px').show();
				}
			});
		},
		eventMouseout: function(event, jsEvent) {
			$('#calendar-poopup').hide();
		}*/
		eventClick: function(event,jsEvent) {
	        /*var offsetTop = Math.abs($(this).offset().top);
	        var offsetLeft = Math.abs($(this).offset().left);
			
			var calendar_container_height = $('.fc-time-grid-container.fc-scroller').height();
			var main_container_height = $('.oc-push').height();
			var t = Math.abs(main_container_height - calendar_container_height - $(this).offset().top);
			
			var calendar_container_width = $('#calendar_popup').width();
			var this_width = $(this).width();
			var l = Math.abs(offsetLeft-this_width);
			
			$.ajax({
				url: "/coordinator/get_event_details/"+event.id,
				success: function(data) {
					$('#calendar-popup').css('top',(t)+'px');
					$('#calendar-popup').html(data);
					$('#calendar-popup').css('left',(l)+'px').show();
				}
			});*/
			coordinator_event_details('show');
			modal_ajax_call("/coordinator/get_event_details/"+event.id,"uide4b3dde6bb5097375d99eb18a83d7146");
		}
    });
    <% if(year != null && year != '' && month != null && month != '' && day != null && day != '') { %>
    	$('#fullcalendar').fullCalendar('gotoDate', '<%= year %>-<%= month %>-<%= day %>');
    <% } %>
</script>
</body>
</html>